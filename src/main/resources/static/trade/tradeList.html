<!DOCTYPE html>
<html>
    <head>
        <title>교환 목록</title>
        <meta charset="utf-8">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            $(document).ready(function () {
                fn_init();
            });
            function fn_init() {
                fn_getTradeList(); // 교환 목록 조회
                fn_setEvent();
            }
            function fn_setEvent() {
                // "거래 요청" 버튼을 초기화
                $('#tradeCreateButton').click(function () {
                    window.location.href = 'tradeCreateForm.html'; // 클릭시 이동할 페이지 지정
                });

                $('.trade-item').click(function () {
                    var tradeId = $(this).data('trade-id');
                    window.location.href = 'tradeInfo.html?tradeNo='+tradeId;
                });
            }
            /**
             * 교환목록 조회
             */
            function fn_getTradeList() {
                // JSON 데이터를 가져오는 비동기 요청
                $.ajax({
                    url: '/api/v1/trades',
                    method: 'GET',
                    dataType: 'json',
                    success: function (data) {
                        var trades = data.trades;

                        for (var i = 0; i < trades.length; i++) {
                            var trade = trades[i];
                            var tradeItem = '<tr class="trade-item" data-trade-id="' + trade.tradeId + '">' +
                                '<td>' + trade.tradeId + '</td>' +
                                '<td>' + trade.tradeType + '</td>' +
                                '<td>' + trade.categoryName + '</td>' +
                                '<td>' + trade.tradeTitle + '</td>' +
                                '<td>' + trade.nickname + '</td>' +
                                '<td>' + trade.createdDate + '</td>' +
                                '</tr>';
                            $('#tradeList').append(tradeItem);
                        }

                        fn_setEvent();
                    },
                    error: function () {
                    }
                });
            }
        </script>
    </head>
    <body>
    <h1 id="boardName">교환 목록</h1>
    <button id="tradeCreateButton">거래 등록</button>
    <table border="1">
        <tr>
            <th>No</th>
            <th>교환구분</th>
            <th>카테고리명</th>
            <th>제목</th>
            <th>작성자</th>
            <th>작성일</th>
        </tr>
        <tbody id="tradeList"></tbody>
    </table>
    </body>
</html>