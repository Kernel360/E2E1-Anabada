<div class="pagetitle">
    <nav>
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">AnabadA</a></li>
            <li class="breadcrumb-item active">자주묻는질문</li>
        </ol>
    </nav>
</div><!-- End Page Title -->

<section class="section">
    <div class="row">
        <div class="col-lg-12">

            <div class="card">
                <div class="card-body">
                    <!-- Table with stripped rows -->
                    <table class="table align-middle">
                        <thead>
                        <tr>
                            <th scope="col">No</th>
                            <th scope="col">제목</th>
                            <th scope="col">작성자</th>
                            <th scope="col">작성일</th>
                        </tr>
                        </thead>
                        <tbody id="faqList">
                        </tbody>
                    </table>

                    <div class="row mb-3">
                        <div class="col-sm-10">
                            <button id="faqCreateButton" class="btn btn-primary">등록</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</section>
<script src="/js/commons.js"></script>
<script>
    $(document).ready(function () {
        fn_init();
    });

    function fn_init() {
        fn_getFaqList(); // FAQ 목록 조회
        fn_setEvent();
    }

    function fn_setEvent() {
        $('#faqCreateButton').click(function () {
            authorize('/faq/faqCreateForm.html');
        });
    }

    function fn_getFaqList() {
        // JSON 데이터를 가져오는 비동기 요청
        $.ajax({
            url: '/api/v1/faqs',
            method: 'GET',
            dataType: 'json',
            headers: {
                'Authorization': 'Bearer ' + localStorage.getItem("accessToken") // 헤더에 토큰 추가
            },
            success: function (data) {
                var faqs = data.faqs;

                for (var i = 0; i < faqs.length; i++) {
                    var faq = faqs[i];
                    var faqItem = '<tr class="faq-item table-list" data-faq-id="' + faq.id + '">' +
                        '<td>' + faq.id + '</td>' +
                        '<td>' + faq.title + '</td>' +
                        '<td>' + faq.nickname + '</td>' +
                        '<td>' + faq.createdDate + '</td>' +
                        '</tr>';
                    $('#faqList').append(faqItem);
                }

                $('.faq-item').click(function () {
                    var faqId = $(this).data('faq-id');
                    authorize('/faq/faqInfo.html?faqId='+faqId);
                });
            },
            error: function () {
                console.log('fail : faq 목록 조회');
            }
        });
    }
</script>

